function YAJET(n){function t(){return"__GSY"+ ++p}function r(n){return n[n.length-1]}function e(n,t,r){for(var e=0,i=n.length,a=new Array(i);--i>=0;)a[e]=t.call(r,n[e++]);return a}function i(n){return n=u(n),"function "+n+"(){"+"return YAJET.process("+o(n)+", this, arguments)}"}function a(a){function f(){return a.charAt(F)}function l(){return a.charAt(F++)}function h(n){return a.substr(F,null!=n?n:V)}function p(n){X.push(n)}function T(){B.length>0&&p("OUT("+o(B)+");"),B=""}function d(n){for(var t=!1;m(" ")||m("	")||m("\n")||m(" ")||!n&&(m("//","\n")||m("/*","*/")||m("<!--","-->"));)t=!0;return t}function U(n){var t=O(n);return t||c("Expecting "+n+" at "+F),t}function x(n){d(),F+=U(n).length}function m(n,t){var r=O(n);if(r&&(F+=r.length,t)){var e=a.indexOf(t,F);-1==e&&c('Unterminated "'+n+'" at '+h()),F=e+t.length}return r}function O(n){return n instanceof RegExp?(n=n.exec(h()))&&{match:n[0],length:n[0].length,groups:n}:h(n.length)==n?{match:n,length:n.length}:null}function b(n,t){t||(t="}"),p(n),N.push(t)}function k(){var n=N.pop();n instanceof Function?n():p(n)}function y(n){var t=X;return X=n,t}function S(n){d();var t=f(),e=v[t];if(e){var i=[e],a="",c=[];for(++F;V>F;){var s=f();if(s==r(i)){if(i.pop(),++F,0==i.length)return n?(a=u(a),a&&c.push(a),c):a;a+=s}else s in v?(i.push(v[s]),++F,a+=s):'"'==s||"'"==s?a+=o(C()):n&&1==i.length&&(m(",")||m(";")||m("=>")||m("..")||m("∈"))?(c.push(a),d(),a=""):d()?a+=" ":(++F,a+=s)}}}function Y(){for(;V>F;){var n=a.indexOf(_,F);if(0>n){B+=h();break}if(n>F&&(B+=h(n-F)),F=n+1,m(_))B+=_;else if(m("#")){if(0==(F=a.indexOf("\n",F)+1))break}else T(),R()}F=V,T()}function C(){var n=f();if("'"==n||'"'==n){var t=F,r=!1,e="";do{++F;var i=f();if(r)switch(i){case"b":i="\b";break;case"f":i="\f";break;case"n":i="\n";break;case"t":i="	";break;case"r":i="\r";break;case"x":++F,i=parseInt(h(2),16),isNaN(i)&&c("Expecting an Unicode character code at: "+F),i=String.fromCharCode(i),F+=2;break;case"u":++F,i=parseInt(h(4),16),isNaN(i)&&c("Expecting an Unicode character code at: "+F),i=String.fromCharCode(i),F+=4}else{if("\\"==i){r=!0;continue}if(i==n)return++F,e}r=!1,e+=i}while(V>F);c("Unterminated string at: "+a.substr(t))}}function J(n){for(var t,r,e="",i=0;t=f(),r=t.charCodeAt(0),r>=65&&90>=r||r>=97&&122>=r||r>=48&&57>=r||95==r||36==r&&!n||124==r||46==r;)e+=t,36==r||124==r||46==r?++i:i=0,++F;return i>0&&(F-=i,e=e.substr(0,e.length-i)),e}function P(){var n=[];for(x("(");V>F;)if(d(),O("("))n.push(S(!0));else{if(m(")"))break;n.push(J())}p("var "+e(n,function(n){return n instanceof Array?n[0]+" = "+n[1]:n}).join(", ")+";")}function R(){if(m("_"))p("VUT($_);");else if(m("-"))d(!0);else if(m("(")){var t=J();if(t){t=t.toLowerCase();var r=n.directives[t]||j[t];r||c("Unknown directive: "+t.toUpperCase()),r.call(I,$)}else--F,p(S()+";")}else if(m(")"))k();else if(m("("))c("Unrecognized construct at "+h());else if(O("{")){var e=S(!0);if(e.length>0&&/\S/.test(e[0])){for(var i=e.shift();e.length>0;){var a=u(e.shift()),f=a.indexOf("("),s=null;f>=0&&(s=u(a.substring(f+1,a.length-1)),a=a.substring(0,f)),s=s?i+", "+s:i,i="YAJET.filter("+o(a)+", "+s+")"}p("VUT("+i+");")}}else{d();for(var e=J(!0).split("|"),i=e.shift();e.length>0;)i="YAJET.filter("+o(e.shift())+", "+i+")";p("VUT("+i+");")}}var X=[],N=[],F=0,V=a.length,B="",I=this,L=[],j={"if":function(){b("if ("+S()+") {")},aif:function(){var n=S(!0),t=n.length>1?n[1]:"it",r=n.length>2?n[2]:t+" != null && "+t+" !== false && "+"!("+t+" instanceof Array && "+t+".length == 0) && "+"!("+t+" === '')";b("(function("+t+") { if ("+r+") {","}}).call(this, "+n[0]+");")},unless:function(){b("if (!("+S()+")) {")},"else":function(){p("} else {"),x(")")},elsif:function(){p("} else if ("+S()+") {"),x(")")},maphash:function(){var n=S(!0),r=n[0],e=n[1],i=n[2],a=t();b("(function("+a+") {"+"for (var "+r+" in "+a+") {"+"if ("+a+".hasOwnProperty("+r+")) try {"+"var "+e+" = "+a+"["+r+"];",A+"}}).call(this, "+i+");")},map:function(){var n,r,e,i=S(!0),a=t(),o=t();3==i.length?(n=i[0],r=i[1],e=i[2]):(n=t(),2==i.length?(r=i[0],e=i[1]):1==i.length&&(e=i[0])),b("(function("+a+") {"+"for (var "+(1==i.length?"$_,":"")+o+" = "+a+".length,"+n+" = 0; "+n+" < "+o+"; ++"+n+") try {"+(1==i.length?"with ($_ = "+a+"["+n+"]) {":"var "+r+" = "+a+"["+n+"];"),(1==i.length?"}":"")+A+"}).call(this, "+e+");")},repeat:function(){var n,r,e=S(!0),i=1,a=t();3==e.length&&(i=e.shift()),n=e.shift(),r=e.shift()||t(),b("(function("+a+") {"+"for (var "+r+" = "+i+"; "+r+" <= "+a+"; ++"+r+") try {",A+"}).call(this, "+n+");")},"continue":function(){p("throw YAJET.X_CONT;"),x(")")},"break":function(){p("throw YAJET.X_BREK;"),x(")")},let:function(){b("(function(){","}).call(this);"),P()},"var":function(){P(),x(")")},"with":function(){b("with ("+S()+") {")},block:function(){d();var n=J(),t=u(S());b("function "+n+"("+t+") {"+w,E+"}")},"export":function(){d();var n=J(),t=u(S());b(n+" = __EXPORTS["+o(n)+"] = function("+t+") {"+w,E+"}; "),L.push(n)},"import":function(){var n=S(!0);x(")"),p(e(n,i).join(";\n")+";")},process:function(){d();var n=J(),t=S();x(")"),p("VUT(YAJET.process("+o(n)+", this, ["+t+"]));")},wrap:function(){d();var n=J(),t=u(S());t&&(t+=", "),n="(typeof "+n+" == 'function' ? "+n+" : YAJET.TEMPLATES."+n+")",b("VUT("+n+".call(this, "+t+"function(OUT, VUT){","}));")},content:function(){p("if (arguments[arguments.length - 1] instanceof Function) arguments[arguments.length - 1].call(this, OUT, VUT);"),x(")")},literal:function(){var n,t,r;d(),n=C()+")",m(/^[ \t\xA0]*\n/),t=a.indexOf(n,F),0>t&&c("Unfinished LITERAL (was looking for "+n),r=a.substring(F,t),F=t+n.length,p("OUT("+o(r)+")")},syntax:function(){var n=_;d(),_=l(),b("",function(){_=n})}};j.when=j["if"],j.awhen=j.aif,j.foreach=j.map;var $={peek:f,next:l,rest:h,out:p,skip_ws:d,assert:U,assert_skip:x,skip:m,looking_at:O,block_open:b,block_close:k,read_balanced:S,read_string:C,read_simple_token:J,read_valist:P,to_js_string:o,trim:u,map:e,set_output:y,directives:n.directives,EX_PARSE:c};Y(),n.with_scope&&(X.unshift("with (this) {"),X.push("}")),L.length>0&&X.unshift("var "+L.join(", ")+";");var M=s.call(this,X.join("\n"));if(L.length>0){var K=M(this.X_IMPORT);for(var q in K)K.hasOwnProperty(q)&&(g[q]=K[q])}return M}function o(n){return'"'+n.replace(/\x5c/g,"\\\\").replace(/\r?\n/g,"\\n").replace(/\t/g,"\\t").replace(/\x22/g,'\\"')+'"'}function c(n){throw new Error(n)}function f(n){throw new Error(n)}function s(n){function t(n){return e.call(n,r)}try{n=T+w+n+d;var r=this,e=new Function("YAJET",n);return t.orig=e,t.code=n,t}catch(i){throw window.console&&console.log("%s",n),i.yajetCode=n,i}}function u(n){return n.replace(/^\s+|\s+$/g,"")}function l(n,t,r,e){e={};for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e}function h(n,t){null==t&&(t=0);var r,e,i;try{r=Array.prototype.slice.call(n,t)}catch(a){for(r=new Array(n.length-t),e=t,i=0;e<n.length;++e,++i)r[i]=n[e]}return r}n=l(n||{},{reader_char:"$",filters:{},directives:{},with_scope:!1});var g=this.TEMPLATES={},p=0,v={"(":")","{":"}","[":"]"},_=n.reader_char;o(_),this.X_CONT={},this.X_BREK={},this.X_IMPORT={};var T="var __EXPORTS = {};",d="return (this === YAJET.X_IMPORT) ? __EXPORTS : __BUF;",w="var __BUF = '', VUT = OUT;function OUT(str) { if (str != null) __BUF += str };",E="return __BUF",A="} catch(ex) { if (ex === YAJET.X_CONT) continue;if (ex === YAJET.X_BREK) break;throw ex;}",U=YAJET.FILTERS={html:function(n){return String(n).replace(/&/g,"&amp;").replace(/\x22/g,"&quot;").replace(/\x27/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00A0/g,"&#xa0;")},upcase:function(n){return String(n).toUpperCase()},downcase:function(n){return String(n).toLowerCase()},plural:function(n,t){return t instanceof Array||(t=arguments.length>2?Array.$(arguments,1):t.split("|")),t=n<t.length?t[n]:t[t.length-1],t.replace(/##?/g,function(t){return 2==t.length?"#":n})},trim:u};this.compile=a,this.filter=function(t){var r=h(arguments,1),e=n.filters[t]||U[t];return e?e.apply(this,r):(f("No filter "+t),void 0)},this.process=function(n,t,r){null==r&&(r=[]);var e=g[n];return e||f("No exported function: "+n),e.apply(t,r)},this.reader_char=function(){return _}}